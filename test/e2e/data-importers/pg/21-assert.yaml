apiVersion: kuttl.dev/v1
kind: TestAssert
timeout: 30
collectors:
  - command: kubectl get db/test-pg-cluster -n ${NAMESPACE} -o yaml
  - command: kubectl get perconapgcluster/test-pg-cluster -n ${NAMESPACE} -o yaml
commands:
  - script: |
      expected=$(printf '1\n2\n3\n4\n5\n6\n7\n8\n9\n10')
      actual=$(kubectl exec pg-client -n ${NAMESPACE} -- psql -t -A -c "select * from test;")
      test "$actual" = "$expected"

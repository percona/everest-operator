apiVersion: kuttl.dev/v1
kind: TestStep
timeout: 10
---
# NOTE: do not change the Secrets, we need the exact credentials for the restore.
apiVersion: v1
data:
  monitor: KF1iWU5ifUgzdW11d0NqQA==
  operator: QWo+ZVhiaz9PTDJVeUVZag==
  proxyadmin: U3lHTjV2TDdsan1Bej1PeEBh
  replication: PyMkUnc2YlNMQT5LSEQyY1o=
  root: U0woVWE8a1cwNFteKSh4enI=
  xtrabackup: TnVNMEk+LGFseVRBNFM4YX0=
kind: Secret
metadata:
  name: everest-secrets-test-pxc-cluster
type: Opaque
---
apiVersion: everest.percona.com/v1alpha1
kind: DatabaseCluster
metadata:
  name: test-pxc-cluster
spec:
  dataSource:
    dataImport:
      dataImporterName: everest-percona-pxc-operator
      source:
        path: "/pxc"
        s3:
          bucket: everest-operator
          region: us-east-1
          endpointURL: https://minio.minio.svc
          credentialsSecretName: test-s3-secret
          verifyTLS: false
          forcePathStyle: true
          accessKeyId: minioadmin
          secretAccessKey: minioadmin
  engine:
    type: pxc
    userSecretsName: everest-secrets-test-pxc-cluster
    replicas: 3
    storage:
      size: 1Gi
    resources:
      cpu: 600m
      memory: 1G
  proxy:
    type: haproxy
    replicas: 3
    resources:
      cpu: 600m
      memory: 0.6G
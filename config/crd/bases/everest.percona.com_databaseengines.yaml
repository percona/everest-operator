---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.14.0
  name: databaseengines.everest.percona.com
spec:
  group: everest.percona.com
  names:
    kind: DatabaseEngine
    listKind: DatabaseEngineList
    plural: databaseengines
    shortNames:
    - dbengine
    singular: databaseengine
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.type
      name: Type
      type: string
    - jsonPath: .status.status
      name: Status
      type: string
    - jsonPath: .status.operatorVersion
      name: Operator Version
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: DatabaseEngine is the Schema for the databaseengines API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: DatabaseEngineSpec is a spec for a database engine.
            properties:
              allowedVersions:
                items:
                  type: string
                type: array
              type:
                description: |-
                  EngineType stands for the supported database engines. Right now it's only pxc
                  and psmdb. However, it can be ps, pg and any other source.
                type: string
            required:
            - type
            type: object
          status:
            description: DatabaseEngineStatus defines the observed state of DatabaseEngine.
            properties:
              availableVersions:
                description: Versions struct represents available versions of database
                  engine components.
                properties:
                  backup:
                    additionalProperties:
                      description: |-
                        Component contains information of the database engine component.
                        Database Engine component can be database engine, database proxy or tools image path.
                      properties:
                        critical:
                          type: boolean
                        imageHash:
                          type: string
                        imagePath:
                          type: string
                        status:
                          description: ComponentStatus represents status of the database
                            engine component.
                          type: string
                      type: object
                    description: ComponentsMap is a map of database engine components.
                    type: object
                  engine:
                    additionalProperties:
                      description: |-
                        Component contains information of the database engine component.
                        Database Engine component can be database engine, database proxy or tools image path.
                      properties:
                        critical:
                          type: boolean
                        imageHash:
                          type: string
                        imagePath:
                          type: string
                        status:
                          description: ComponentStatus represents status of the database
                            engine component.
                          type: string
                      type: object
                    description: ComponentsMap is a map of database engine components.
                    type: object
                  proxy:
                    additionalProperties:
                      additionalProperties:
                        description: |-
                          Component contains information of the database engine component.
                          Database Engine component can be database engine, database proxy or tools image path.
                        properties:
                          critical:
                            type: boolean
                          imageHash:
                            type: string
                          imagePath:
                            type: string
                          status:
                            description: ComponentStatus represents status of the
                              database engine component.
                            type: string
                        type: object
                      description: ComponentsMap is a map of database engine components.
                      type: object
                    type: object
                  tools:
                    additionalProperties:
                      additionalProperties:
                        description: |-
                          Component contains information of the database engine component.
                          Database Engine component can be database engine, database proxy or tools image path.
                        properties:
                          critical:
                            type: boolean
                          imageHash:
                            type: string
                          imagePath:
                            type: string
                          status:
                            description: ComponentStatus represents status of the
                              database engine component.
                            type: string
                        type: object
                      description: ComponentsMap is a map of database engine components.
                      type: object
                    type: object
                type: object
              operatorUpgrade:
                description: |-
                  OperatorUpgrade contains the status of the operator upgrade.
                  This is set only if the `everest.percona.com/upgrade-operator-to` annotation is present.
                properties:
                  installPlanRef:
                    description: InstallPlanRef is a reference to the InstallPlan
                      object created for the operator upgrade.
                    properties:
                      name:
                        default: ""
                        description: |-
                          Name of the referent.
                          This field is effectively required, but due to backwards compatibility is
                          allowed to be empty. Instances of this type with an empty value here are
                          almost certainly wrong.
                          TODO: Add other useful fields. apiVersion, kind, uid?
                          More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                          TODO: Drop `kubebuilder:default` when controller-gen doesn't need it https://github.com/kubernetes-sigs/kubebuilder/issues/3896.
                        type: string
                    type: object
                    x-kubernetes-map-type: atomic
                  message:
                    type: string
                  phase:
                    description: UpgradePhase represents the phase of the operator
                      upgrade.
                    type: string
                  startedAt:
                    format: date-time
                    type: string
                  targetVersion:
                    description: TargetVersion is the version to which the operator
                      should be upgraded.
                    type: string
                type: object
              operatorVersion:
                type: string
              pendingOperatorUpgrades:
                items:
                  description: OperatorUpgrade contains the information about the
                    operator upgrade.
                  properties:
                    installPlanRef:
                      description: InstallPlanRef is a reference to the InstallPlan
                        object created for the operator upgrade.
                      properties:
                        name:
                          default: ""
                          description: |-
                            Name of the referent.
                            This field is effectively required, but due to backwards compatibility is
                            allowed to be empty. Instances of this type with an empty value here are
                            almost certainly wrong.
                            TODO: Add other useful fields. apiVersion, kind, uid?
                            More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                            TODO: Drop `kubebuilder:default` when controller-gen doesn't need it https://github.com/kubernetes-sigs/kubebuilder/issues/3896.
                          type: string
                      type: object
                      x-kubernetes-map-type: atomic
                    targetVersion:
                      description: TargetVersion is the version to which the operator
                        should be upgraded.
                      type: string
                  type: object
                type: array
              status:
                description: EngineState represents state of engine in a k8s cluster.
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

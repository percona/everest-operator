apiVersion: kuttl.dev/v1
kind: TestStep
---
apiVersion: everest.percona.com/v1alpha1
kind: DatabaseCluster
metadata:
  name: pg-lbc
spec:
  proxy:
    expose:
      loadBalancerConfigName: lbc-custom-pg
---
#simulate existence of the LB service
apiVersion: v1
kind: Service
metadata:
  name: pg-lbc-pgbouncer
  labels:
    app.kubernetes.io/instance: pg-lbc
    app.kubernetes.io/component: pgbouncer
spec:
  type: LoadBalancer
  selector:
    app.kubernetes.io/component: pgbouncer
  ports:
    - port: 3306
      targetPort: 3306
      protocol: TCP

apiVersion: kuttl.dev/v1
kind: TestAssert
timeout: 30
collectors:
  - command: kubectl -n $NAMESPACE get db/pxc-mc -o yaml
  - command: kubectl -n $NAMESPACE get monitoringconfig/test-mc -o yaml
  - command: kubectl -n $NAMESPACE get secret/mc-secret -o yaml
  - command: kubectl -n $NAMESPACE get pxc/pxc-mc -o yaml
  - command: kubectl -n $NAMESPACE get secret/everest-secrets-pxc-mc -o yaml
commands:
  - command: kubectl wait --for=delete db/pxc-mc -n $NAMESPACE
  - command: kubectl wait --for=delete pxc/pxc-mc -n $NAMESPACE
  - command: kubectl wait --for=delete monitoringconfig/test-mc -n $NAMESPACE
  - command: kubectl wait --for=delete secret/mc-secret -n $NAMESPACE
  - command: kubectl wait --for=delete vmagent/everest-monitoring -n $NAMESPACE
  - command: kubectl wait --for=delete secret/everest-secrets-pxc-mc -n $NAMESPACE

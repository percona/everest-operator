apiVersion: kuttl.dev/v1
kind: TestAssert
timeout: 30
collectors:
  - command: kubectl -n $NAMESPACE get db/psmdb-mc -o yaml
  - command: kubectl -n $NAMESPACE get monitoringconfig/test-mc -o yaml
  - command: kubectl -n $NAMESPACE get secret/mc-secret -o yaml
  - command: kubectl -n $NAMESPACE get psmdb/psmdb-mc -o yaml
  - command: kubectl -n $NAMESPACE get secret/everest-secrets-psmdb-mc -o yaml
commands:
  - command: kubectl wait --for=delete db/psmdb-mc -n $NAMESPACE
  - command: kubectl wait --for=delete psmdb/psmdb-mc -n $NAMESPACE
  - command: kubectl wait --for=delete monitoringconfig/test-mc -n $NAMESPACE
  - command: kubectl wait --for=delete secret/mc-secret -n $NAMESPACE
  - command: kubectl wait --for=delete vmagent/everest-monitoring -n $NAMESPACE
  - command: kubectl wait --for=delete secret/everest-secrets-psmdb-mc -n $NAMESPACE

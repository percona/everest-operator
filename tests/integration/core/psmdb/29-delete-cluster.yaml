apiVersion: kuttl.dev/v1
kind: TestStep
timeout: 10
commands:
  - script: kubectl -n $NAMESPACE delete db test-psmdb-cluster --wait=false && sleep 5
  - command: kubectl patch psmdb test-psmdb-cluster -n $NAMESPACE -p '{"metadata":{"finalizers":null}}' --type merge
  - command: kubectl wait --for=delete db/test-psmdb-cluster -n $NAMESPACE
  - command: kubectl delete podschedulingpolicy/everest-default-psmdb -n $NAMESPACE --wait=false
  - command: kubectl patch podschedulingpolicy/everest-default-psmdb -n $NAMESPACE -p '{"metadata":{"finalizers":null}}' --type merge
  - command: kubectl wait --for=delete podschedulingpolicy/everest-default-psmdb -n $NAMESPACE
